// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "darwin-arm64"]
  output        = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                 Int         @id @default(autoincrement())
  firstName          String
  lastName           String
  phoneNumber        String      @unique
  password           String
  createdAt          DateTime    @default(now())
  updatedAt          DateTime    @updatedAt
  numOfShares        Int
  bills              ShareBill[]
  loans              Loan[]
  balance            Int         @default(0)
  role               Role        @default(USER)
  mustChangePassword Boolean     @default(true)
}

enum Status {
  ONGOING
  COMPLETED
}

enum Role {
  ADMIN
  USER
}

model Loan {
  id          Int        @id @default(autoincrement())
  amount      Int
  debt        Int
  status      Status     @default(ONGOING)
  user        User       @relation(fields: [userId], references: [id])
  userId      Int
  bills       LoanBill[]
  description String?
  date        DateTime
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model ShareBill {
  id          Int      @id @default(autoincrement())
  amount      Int
  user        User     @relation(fields: [userId], references: [id])
  userId      Int
  description String?
  date        DateTime
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model LoanBill {
  id          Int      @id @default(autoincrement())
  amount      Int
  loan        Loan     @relation(fields: [loanId], references: [id])
  loanId      Int
  description String?
  date        DateTime
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
